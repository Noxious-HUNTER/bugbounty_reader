import requests
from bs4 import BeautifulSoup
from tqdm import tqdm

def collect():
    url = "https://pentester.land/writeups/"
    writeups = []

    print(f"ðŸ“¡ Fetching: {url}")
    response = requests.get(url)
    soup = BeautifulSoup(response.text, "html.parser")

    rows = soup.find_all("tr")
    for row in tqdm(rows, desc="Extracting writeups"):
        try:
            title = row.find("td", class_="sorting_1").text.strip()
            url = row.find("td", class_="sorting_1").a["href"]
            description = row.find("td", class_="sorting_2").text.strip()
            date = row.find("td", class_="sorting_3").text.strip()
            writeups.append({
                "title": title,
                "url": url,
                "description": description,
                "date": date,
                "source": "pentesterland",
                "tags": ["pentesting"]
            })
        except AttributeError:
            continue

    return writeups
